# myisamchk 是用来做什么的？

 它用来压缩 MyISAM 表，这减少了磁盘或内存使用。 MyISAM Static 和 MyISAM Dynamic 有什么区别？ 在 MyISAM Static 上的所有字段有固定宽度。动态 MyISAM 表将具有像 TEXT， BLOB 等字段，以适应不同长度的数据类型。 MyISAM Static 在受损情况下更容易恢复。

# 如果一个表有一列定义为 TIMESTAMP，将发生什么？ 

每当行被更改时，时间戳字段将获取当前时间戳。

 **列设置为 AUTO INCREMENT 时，如果在表中达到最大值，会发生什么情况？**

 它会停止递增，任何进一步的插入都将产生错误，因为密钥已被使用。

 **怎样才能找出最后一次插入时分配了哪个自动增量？**

 LAST_INSERT_ID 将返回由 Auto_increment 分配的最后一个值，并且不需要指 定表名称。

# 你怎么看到为表格定义的所有索引？ 

索引是通过以下方式为表格定义的：

```sql
SHOW INDEX FROM <tablename>;
```

# LIKE 声明中的％和 _ 是什么意思？_

％对应于 0 个或更多字符，_只是 LIKE 语句中的一个字符。 

**如何在 Unix 和 MySQL 时间戳之间进行转换？**

UNIX_TIMESTAMP 是从 MySQL 时间戳转换为 Unix 时间戳的命令 

FROM_UNIXTIME 是从 Unix 时间戳转换为 MySQL 时间戳的命令

# 列对比运算符是什么？

在 SELECT 语句的列比较中使用=，<>，<=，<，> =，>，<<，>>，<=>，AND， OR 或 LIKE 运算符。

# BLOB 和 TEXT 有什么区别？

 BLOB 是一个二进制对象，可以容纳可变数量的数据。TEXT 是一个不区分大小写 的 BLOB。 BLOB 和 TEXT 类型之间的唯一区别在于对 BLOB 值进行排序和比较时区分大小 写，对 TEXT 值不区分大小写。

# MySQL_fetch_array 和 MySQL_fetch_object 的区别是 什么？

以下是 MySQL_fetch_array 和 MySQL_fetch_object 的区别： 

MySQL_fetch_array（） – 将结果行作为关联数组或来自数据库的常规数组返回。 

MySQL_fetch_object – 从数据库返回结果行作为对象。

# MyISAM 表格将在哪里存储，并且还提供其存储格式？

每个 MyISAM 表格以三种格式存储在磁盘上：

- ·“.frm”文件存储表定义 
- 数据文件具有“.MYD”（MYData）扩展名 
- 索引文件具有“.MYI”（MYIndex）扩展名

# MySQL 如何优化 DISTINCT？

DISTINCT 在所有列上转换为 GROUP BY，并与 ORDER BY 子句结合使用。 SELECT DISTINCT t1.a FROM t1,t2 where t1.a=t2.a;

# 可以使用多少列创建索引？ 

任何标准表最多可以创建 16 个索引列。

## NOW（）和 CURRENT_DATE（）有什么区别？

 NOW（）命令用于显示当前年份，月份，日期，小时，分钟和秒。 CURRENT_DATE（）仅显示当前年份，月份和日期。

# 什么是非标准字符串类型？

 1、TINYTEXT 2、TEXT 3、MEDIUMTEXT 4、LONGTEXT

# 什么是通用 SQL 函数？

1、CONCAT(A, B) – 连接两个字符串值以创建单个字符串输出。通常用于将两个 或多个字段合并为一个字段。

2、FORMAT(X, D)- 格式化数字 X 到 D 有效数字。

 3、CURRDATE(), CURRTIME()- 返回当前日期或时间。

 4、NOW（） – 将当前日期和时间作为一个值返回。

 5、MONTH（），DAY（），YEAR（），WEEK（），WEEKDAY（） – 从日期 值中提取给定数据。

 6、HOUR（），MINUTE（），SECOND（） – 从时间值中提取给定数据。

 7、DATEDIFF（A，B） – 确定两个日期之间的差异，通常用于计算年龄

 8、SUBTIMES（A，B） – 确定两次之间的差异。

 9、FROMDAYS（INT） – 将整数天数转换为日期值。

# MySQL 里记录货币用什么字段类型好 

NUMERIC 和 DECIMAL 类型被 MySQL 实现为同样的类型，这在 SQL92 标准允 许。他们被用于保存值，该值的准确精度是极其重要的值，例如与金钱有关的数 据。当声明一个类是这些类型之一时，精度和规模的能被(并且通常是)指定。 

例如： salary DECIMAL(9,2) 

在这个例子中，9(precision)代表将被用于存储值的总的小数位数，而 2(scale)代 表将被用于存储小数点后的位数。 因此，在这种情况下，能被存储在 salary 列中的值的范围是从-9999999.99 到 9999999.99。

# MySQL 有关权限的表都有哪几个？

MySQL 服务器通过权限表来控制用户对数据库的访问，权限表存放在 MySQL 数 据库里，由 MySQL_install_db 脚本初始化。这些权限表分别 user，db，table_priv， columns_priv 和 host。

# 列的字符串类型可以是什么？

字符串类型是： 

1、SET2、BLOB 3、ENUM 4、CHAR 5、TEXT

# MySQL 数据库作发布系统的存储，一天五万条以上的增量， 预计运维三年,怎么优化？ 

1、设计良好的数据库结构，允许部分数据冗余，尽量避免 join 查询，提高效率。 2、选择合适的表字段数据类型和存储引擎，适当的添加索引。 3、MySQL 库主从读写分离。 4、找规律分表，减少单表中的数据量提高查询速度。 5、添加缓存机制，比如 memcached，apc 等。 6、不经常改动的页面，生成静态页面。 7、书写高效率的 SQL。比如 SELECT * FROM TABEL 改为 SELECT field_1, field_2, field_3 FROM TABLE.

# 锁的优化策略

1、读写分离 2、分段加锁 3、减少锁持有的时间 4.多个线程尽量以相同的顺序去获取资源 

不能将锁的粒度过于细化，不然可能会出现线程的加锁和释放次数过多，反而效 率不如一次加一把大锁。

# 索引的底层实现原理和优化

B+树，经过优化的 B+树 主要是在所有的叶子结点中增加了指向下一个叶子节点的指针，因此 InnoDB 建 议为大部分表使用默认自增的主键作为主索引。

# 什么情况下设置了索引但无法使用

1、以“%”开头的 LIKE 语句，模糊匹配 

2、OR 语句前后没有同时使用索引 

3、数据类型出现隐式转化（如 varchar 不加单引号的话可能会自动转换为 int 型）

# SQL优化

[阿里P8架构师谈：MySQL慢查询优化、索引优化、以及表等优化总结 | 优知学院 (youzhixueyuan.com)](https://youzhixueyuan.com/MySQL-slow-query-optimization-index-optimization.html)

# 简单描述 MySQL 中，索引，主键，唯一索引，联合索引 的区别，对数据库的性能有什么影响（从读写两方面）

索引是一种特殊的文件(InnoDB 数据表上的索引是表空间的一个组成部分)，它们 包含着对数据表里所有记录的引用指针。 

普通索引(由关键字 KEY 或 INDEX 定义的索引)的唯一任务是加快对数据的访问速 度。

 普通索引允许被索引的数据列包含重复的值。如果能确定某个数据列将只包含彼 此各不相同的值，在为这个数据列创建索引的时候就应该用关键字 UNIQUE 把它 定义为一个唯一索引。也就是说，唯一索引可以保证数据记录的唯一性。 

主键，是一种特殊的唯一索引，在一张表中只能定义一个主键索引，主键用于唯 一标识一条记录，使用关键字 PRIMARY KEY 来创建。 索引可以覆盖多个数据列，如像 INDEX(columnA, columnB)索引，这就是联合索 引。

 索引可以极大的提高数据的查询速度，但是会降低插入、删除、更新表的速度， 因为在执行这些写操作时，还要操作索引文件。

# SQL 注入漏洞产生的原因？如何防止？

 SQL 注入产生的原因：程序开发过程中不注意规范书写 sql 语句和对特殊字符进 行过滤，导致客户端可以通过全局变量 POST 和 GET 提交一些 sql 语句正常执行。 

防止 SQL 注入的方式： 开启配置文件中的 magic_quotes_gpc 和 magic_quotes_runtime 设置

执行 sql 语句时使用 addslashes 进行 sql 语句转换 Sql 语句书写尽量不要省略双引号和单引号。 过滤掉 sql 语句中的一些关键词：update、insert、delete、select、 * 。 提高数据库表和字段的命名技巧，对一些重要的字段根据程序的特点命名，取不 易被猜到的。

# 为表中得字段选择合适得数据类型

字段类型优先级: 整形>date,time>enum,char>varchar>blob,text 优先考虑数字类型，其次是日期或者二进制类型，最后是字符串类型，同级别得 数据类型，应该优先选择占用空间小的数据类型

# 存储时期

Datatime:以 YYYY-MM-DD HH:MM:SS 格式存储时期时间，精确到秒， 占用 8 个字节得存储空间，datatime 类型与时区无关

 Timestamp:以时间戳格式存储，占用 4 个字节，范围小 1970-1-1 到 2038-1-19， 显示依赖于所指定得时区，默认在第一个列行的数据修改时可以自动得修改 timestamp 列得值 

Date:（生日）占用得字节数比使用字符串.datatime.int 储存要少，使用 date 只 需要 3 个字节，存储日期月份，还可以利用日期时间函数进行日期间得计算

 Time:存储时间部分得数据 注意:不要使用字符串类型来存储日期时间数据（通常比字符串占用得储存空间小， 在进行查找过滤可以利用日期得函数）

 使用 int 存储日期时间不如使用 timestamp 类型

# 解释 MySQL 外连接、内连接与自连接的区别

先说什么是交叉连接: 交叉连接又叫笛卡尔积，它是指不使用任何条件，直接将一 个表的所有记录和另一个表中的所有记录一一匹配。 

内连接 则是只有条件的交叉连接，根据某个条件筛选出符合条件的记录，不符合 条件的记录不会出现在结果集中，即内连接只连接匹配的行。 

外连接 其结果集中不仅包含符合连接条件的行，而且还会包括左表、右表或两个 表中 的所有数据行，这三种情况依次称之为左外连接，右外连接，和全外连接。

 左外连接，也称左连接，左表为主表，左表中的所有记录都会出现在结果集中， 对于那些在右表中并没有匹配的记录，仍然要显示，右边对应的那些字段值以 NULL 来填充。右外连接，也称右连接，右表为主表，右表中的所有记录都会出现 在结果集中。左连接和右连接可以互换，MySQL 目前还不支持全外连接。

# 完整性约束包括哪些？ 

数据完整性(Data Integrity)是指数据的精确(Accuracy)和可靠性(Reliability)。 

分为以下四类：

 1、实体完整性：规定表的每一行在表中是惟一的实体。 

2、域完整性：是指表中的列必须满足某种特定的数据类型约束，其中约束又包括 取值范围、精度等规定。 

3、参照完整性：是指两个表的主关键字和外关键字的数据应一致，保证了表之间 的数据的一致性，防止了数据丢失或无意义的数据在数据库中扩散。

4、用户定义的完整性：不同的关系数据库系统根据其应用环境的不同，往往还需 要一些特殊的约束条件。用户定义的完整性即是针对某个特定关系数据库的约束 条件，它反映某一具体应用必须满足的语义要求。 

与表有关的约束：包括列约束(NOT NULL（非空约束）)和表约束(PRIMARY KEY、 foreign key、check、UNIQUE) 。

# NULL 是什么意思

 答：NULL 这个值表示 UNKNOWN(未知):它不表示“”(空字符串)。对 NULL 这 个值的任何比较都会生产一个 NULL 值。您不能把任何值与一个 NULL 值进行比 较，并在逻辑上希望获得一个答案。 使用 IS NULL 来进行 NULL 判断

# 你可以用什么来确保表格里的字段只接受特定范围里的值? 

答：Check 限制，它在数据库表格里被定义，用来限制输入该列的值。 触发器也可以被用来限制数据库表格里的字段能够接受的值，但是这种办法要求 触发器在表格里被定义，这可能会在某些情况下影响到性能。